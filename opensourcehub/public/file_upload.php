<?php require_once __DIR__ . '/../src/config_path.php'; require_once __DIR__ . '/../src/auth.php'; require_once __DIR__ . '/../src/repos.php'; require_once __DIR__ . '/../src/files.php'; require_login(); $repo_id = (int)($_POST['repo_id'] ?? 0); $filename = trim($_POST['filename'] ?? ''); $content = $_POST['content'] ?? ''; $repo = get_repository($repo_id); if (!$repo || $repo['user_id'] != $_SESSION['user_id']) { exit('Доступ запрещён'); } if ($filename !== '') { add_file_to_repo($repo_id, $filename, $content); } header('Location: ' . BASE_URL . 'repo.php?id=' . $repo_id); exit;